<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <link rel="apple-touch-icon" sizes="180x180" href="{{ site.baseUrl }}/assets/favicon/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="{{ site.baseUrl }}/assets/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="{{ site.baseUrl }}/assets/favicon/favicon-16x16.png">
  <link rel="manifest" href="{{ site.baseUrl }}/assets/favicon/site.webmanifest">

  <!-- stylesheet -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css">
  <link rel="stylesheet" href="{{ site.baseUrl }}/{{ 'assets/css/tailwind.css' | url }}">
  <link rel="stylesheet" href="{{ site.baseUrl }}/assets/css/tobii.min.css">

  <!-- Meta -->
  <title>{{site.title}}{% if title %} - {{title}} {% endif %} </title>
  <meta name="description" content="
      {% if description %}
        {{description}}
      {% else %}
        {{site.description}}
      {% endif %}
    " />

</head>

<body class="bg-neutral-900">

  {% include "partials/_navigation.njk" %}

  <div class="pt-16">
    {{ content | safe }}
  </div>

  {% include "partials/_footer.njk" %}

  <script src="{{ site.baseUrl }}/assets/js/tobii.min.js"></script>
  <script src="{{ site.baseUrl }}/assets/js/menu.js"></script>
  <script src="{{ site.baseUrl }}/assets/js/email.js"></script>
  <script>

    var enableLightbox = true;  // Set this based on your specific condition

    function setupLightboxLinks() {
      if (enableLightbox) {

        const images = document.querySelectorAll('img');  // Select all image elements

        // Wrap images into groups

        let currentGroup = [];
        let lastImage = null;

        function wrapImages(images) {
          if (images.length > 0) {
            const wrapper = document.createElement('div');
            wrapper.className = 'columns-2 md:columns-3 not-prose mt-5';
            images[0].parentNode.insertBefore(wrapper, images[0]);

            images.forEach(img => {
              wrapper.appendChild(img);
            });
          }
        }

        images.forEach((img, index) => {
          if (lastImage && img.previousElementSibling === lastImage) {
            currentGroup.push(img);
          } else {
            wrapImages(currentGroup);
            currentGroup = [img];
          }
          lastImage = img;

          // If it's the last image and there's a group, wrap it
          if (index === images.length - 1) {
            wrapImages(currentGroup);
          }
        });

        // Turn images into lightroom links
        images.forEach(img => {
          // Only wrap images that are not already inside an anchor tag
          if (img.parentNode.tagName !== 'A') {
            const wrapper = document.createElement('a');
            wrapper.setAttribute('href', img.src);  // Set href to the image src or a larger image URL
            wrapper.setAttribute('class', 'lightbox');  // Add the 'lightbox' class

            // Insert the wrapper into the DOM and move the img inside it
            img.parentNode.insertBefore(wrapper, img);
            wrapper.appendChild(img);
          }
        });

        // Init Lightroom plugin for media gallery
        const tobii = new Tobii({
          // captions: false,
          counter: false,
          zoom: false
        })

      }
    }

    // Call the function when the document is ready
    document.addEventListener('DOMContentLoaded', setupLightboxLinks);

  </script>
  {% if item.data.title === "Home" %}
  <script src="{{ site.baseUrl }}/assets/js/video.js"></script>
  {% endif %}


</body>

</html>